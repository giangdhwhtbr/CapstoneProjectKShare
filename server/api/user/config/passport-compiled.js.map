{"version":3,"sources":["passport.js"],"names":[],"mappings":";;;;;AAGA,IAAI,gBAAkB,QAAQ,gBAAR,EAA0B,QAAhD;AACA,IAAI,OAAO,QAAQ,UAAR,EAAoB,KAApB,CAA0B,MAA1B,CAAX;;AAGA,OAAO,OAAP,GAAiB,UAAS,QAAT,EAAkB;;;AAGjC,WAAS,aAAT,CAAuB,UAAU,IAAV,EAAgB,IAAhB,EAAsB;AAC3C,SAAK,IAAL,EAAW,KAAK,EAAhB;AACD,GAFD;;;AAKA,WAAS,eAAT,CAAyB,UAAU,EAAV,EAAc,IAAd,EAAoB;AAC3C,SAAK,OAAL,CAAa;AACX,WAAK;AADM,KAAb,EAEG,iBAFH,EAEsB,UAAU,GAAV,EAAe,IAAf,EAAqB;;AAEzC,WAAK,GAAL,EAAU,IAAV;AACD,KALD;AAMD,GAPD;;;AAUA,WAAS,GAAT,CAAa,aAAb,EAA4B,IAAI,aAAJ,CAAkB;AAC5C,mBAAgB,UAD4B;AAE5C,mBAAgB,UAF4B;AAG5C,uBAAmB;AAHyB,GAAlB,EAK1B,UAAS,GAAT,EAAc,QAAd,EAAwB,QAAxB,EAAkC,IAAlC,EAAuC;AACrC,SAAK,OAAL,CAAa,EAAE,YAAa,QAAf,EAAb,EAAwC,UAAU,GAAV,EAAe,IAAf,EAAoB;AACzD,UAAG,GAAH,EAAO;AACL,eAAO,KAAK,GAAL,CAAP;AACD;AACD,UAAG,CAAC,IAAJ,EAAS;AACP,eAAO,KAAK,IAAL,EAAU,KAAV,EAAiB,IAAI,KAAJ,CAAU,cAAV,EAAyB,gBAAzB,CAAjB,CAAP;AACD;AACD,UAAG,CAAC,KAAK,YAAL,CAAkB,QAAlB,CAAJ,EAAgC;AAC9B,eAAO,KAAK,IAAL,EAAW,KAAX,EAAkB,IAAI,KAAJ,CAAU,8BAAV,CAAlB,CAAP;AACD;AACD,aAAO,KAAK,IAAL,EAAW,IAAX,CAAP;AACF,KAXD;AAYD,GAlByB,CAA5B;AAqBD,CAvCD","file":"passport-compiled.js","sourcesContent":["/**\n * Created by GiangDH on 5/18/16.\n */\nvar LocalStrategy   = require('passport-local').Strategy;\nvar User = require('mongoose').model('User');\n\n\nmodule.exports = function(passport){\n\n  // Serialize sessions\n  passport.serializeUser(function (user, done) {\n    done(null, user.id);\n  });\n\n  // Deserialize sessions\n  passport.deserializeUser(function (id, done) {\n    User.findOne({\n      _id: id\n    }, '-salt -password', function (err, user) {\n      //console.log(user);\n      done(err, user);\n    });\n  });\n\n  // Local Sign In\n  passport.use('local-login', new LocalStrategy({\n    usernameField : 'username',\n    passwordField : 'password',\n    passReqToCallback: true\n  },\n    function(req, username, password, done){\n      User.findOne({ 'username' : username }, function (err, user){\n         if(err){\n           return done(err);\n         }\n         if(!user){\n           return done(null,false, req.flash('loginMessage','No user found.'));\n         }\n         if(!user.authenticate(password)){\n           return done(null, false, req.flash('Invalid password, try again!'));\n         }\n         return done(null, user);\n      })\n    }\n  ))\n\n}\n"]}